<!DOCTYPE html>
<html lang="en">

<head>
    <title>Alpha Builders</title>
    <!-- HTML5 Shim and Respond.js IE10 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 10]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->
    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description"
        content="HUNGARY" />
    <meta name="keywords"
        content="HUNGARY" />
    <meta name="author" content="CodedThemes" />


    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <!-- Favicon icon -->
    <link rel="icon" href="../assets/images/Alpha-Builders.jpg" type="image/x-icon">
    <!-- fontawesome icon -->
    <link rel="stylesheet" href="../assets/fonts/fontawesome/css/fontawesome-all.min.css">
    <!-- animation css -->
    <link rel="stylesheet" href="../assets/plugins/animation/css/animate.min.css">
    <!-- vendor css -->
    <link rel="stylesheet" href="../assets/css/style.css">

    <style>
        .pcoded-micon:hover{
            color: white !important;
        }

        .pcoded-mtext:hover{
            color: white !important;
        }

        .nav-link:hover{
            color: white !important; 
        }

        .nav-item:hover{
            color: white !important;
        }

        .places {
            transition: transform 0.25s ease-in-out;
            box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        }

        .places:hover {
            cursor: pointer;
            transform: scale(1.05);

        }

        


        .card123 {
            transition: transform 0.25s ease-in-out;
            /* background-color: #8EC5FC;
    background-image: linear-gradient(62deg, #8EC5FC 0%, #E0C3FC 100%); */
            color: white;
        }

        .card123 :hover {
            cursor: pointer;
            transform: scale(1.05);
        }

       /* .navbarLink1{
            display: none;

        }*/

        /*.navbarLink2{
            display: none;
        }*/

        .navbarLink3{
            display: none;
        }

        .navbarLink4{
            display: none;
        }

        .navbarLink5{
            display: none;
        }

        .navbarLink6{
            display: none;
        }

        .navbarLink7{
            display: none;
        }

        .navbarLink8{
            display: none;
        }

        .navbarLink9{
            display: none;
        }

        .navbarLink10{
            display: none;
        }

       .navbarLink11{
            display: none;
        }

        .navbarLink12{
            display: none;
        }

        .navbarLink13{
            display: none;
        }


        .circle {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        display: inline-block;
    }

    .circle.red {
        background-color: red;
    }

    .circle.green {
        background-color: green;
    }

    .blink {
        animation: blink 1s infinite;
    }

    @keyframes blink {
        0% { opacity: 1; }
        50% { opacity: 0; }
        100% { opacity: 1; }
    }

    #downloadExcelButton{
        display: none;
    }

        
    </style>
    

</head>

<body>
    <!-- [ Pre-loader ] start -->
    <div class="loader-bg">
        <div class="loader-track">
            <div class="loader-fill"></div>
        </div>
    </div>
    <!-- [ Pre-loader ] End -->

    <!-- [ navigation menu ] start -->
    <nav class="pcoded-navbar">
        <div class="navbar-wrapper">
            <div class="navbar-brand header-logo">
                <a href="employee.html" class="b-brand">
                    <img style="margin-top: 100px; object-fit: contain;" src="../assets/images/Alpha-Builders.jpg"
                        width="100%" alt="">
                </a>
                <a class="mobile-menu" id="mobile-collapse" href="javascript:"><span></span></a>
            </div>
            <div style="margin-top: 40px;" class="navbar-content scroll-div">
                <ul class="nav pcoded-inner-navbar">
                    <li class="nav-item pcoded-menu-caption">

                    </li>
                    <li data-username="dashboard Default Ecommerce CRM Analytics Crypto Project"
                        class="nav-item mt-5">
                        <a href="employee.html" class="nav-link "><span class="pcoded-micon"><i
                                    class="feather icon-home"></i></span><span class="pcoded-mtext">Admin
                                Dashboard</span></a>
                    </li>

                    <li class="nav-item pcoded-menu-caption">
                        <label>Tables</label>
                    </li>


                    <!-- <li data-username="form elements advance componant validation masking wizard picker select" class="nav-item">
                        <a href="./applicant_form.html" class="nav-link "><span class="pcoded-micon"><i class="feather icon-file-text"></i></span><span class="pcoded-mtext">Enquiry Form</span></a>
                    </li> -->

                    
                    <!-- <li data-username="Table bootstrap datatable footable" class="nav-item">
                        <a href="./employeeTotalApplicants.html" class="nav-link "><span class="pcoded-micon"><i class="fa-solid fa-person"></i></span><span class="pcoded-mtext">Total Applicant
                                List</span></a>
                    </li> -->

                    <li data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Tooltip on top" class="nav-item navbarLink1">
                        <a href="employeeAdd.html" class="nav-link "><span class="pcoded-micon"><i class="fa-solid fa-person"></i></span><span class="pcoded-mtext">Add Employee
                                </span></a>
                    </li>

                    <li data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Tooltip on top" class="nav-item navbarLink2 active">
                        <a href="employeeAttendance.html" class="nav-link "><span class="pcoded-micon"><i class="fa-solid fa-id-card"></i></span><span class="pcoded-mtext">Employee Attendance
                                </span></a>
                    </li>

                    <li data-username="Table bootstrap datatable footable" class="nav-item navbarLink3">
                        <a href="./employeeApplicantList.html" class="nav-link "><span class="pcoded-micon"><i class="fa-solid fa-person"></i></span><span class="pcoded-mtext">Applicant
                                List</span></a>
                    </li>

                    <li data-username="Table bootstrap datatable footable" class="nav-item navbarLink4">
                        <a href="./employeePaymentsTab.html" class="nav-link "><span class="pcoded-micon"><i class="fa-solid fa-person"></i></span><span class="pcoded-mtext">Payments
                                </span></a>
                    </li>

                    <li data-username="Table bootstrap datatable footable" class="nav-item navbarLink5">
                        <a href="./employeeEnquiry.html" class="nav-link "><span class="pcoded-micon"><i class="fa-regular fa-envelope"></i></span><span  class="pcoded-mtext">Enquiry
                                Form</span></a>
                    </li>

                    <li data-username="Table bootstrap datatable footable" class="nav-item navbarLink6">
                        <a href="./employeeProject.html" class="nav-link "><span class="pcoded-micon"><i class="fa-regular fa-file"></i></span><span class="pcoded-mtext">All Projects</span></a>
                    </li>

                    <li data-username="Table bootstrap datatable footable" class="nav-item navbarLink7">
                        <a href="./employeePendings.html" class="nav-link "><span class="pcoded-micon"><i class="fa-solid fa-clock-rotate-left"></i></span><span
                                class="pcoded-mtext">Pendings</span></a>
                    </li>

                    <li data-username="Table bootstrap datatable footable" class="nav-item navbarLink8">
                        <a href="./employeeOngoing.html" class="nav-link "><span class="pcoded-micon"><i class="fa-regular fa-calendar-check"></i></span><span
                                class="pcoded-mtext">Ongoing</span></a>
                    </li>

                    <li data-username="Table bootstrap datatable footable" class="nav-item navbarLink9">
                        <a href="./employeeCompleted.html" class="nav-link "><span class="pcoded-micon"><i class="fa-solid fa-house-circle-check"></i></span><span
                                class="pcoded-mtext">Completed</span></a>
                    </li>

                    <li data-username="Table bootstrap datatable footable" class="nav-item navbarLink10">
                        <a href="employeeUpcoming.html" class="nav-link "><span class="pcoded-micon"><i class="fa-regular fa-square-plus"></i></span><span class="pcoded-mtext">Upcoming</span></a>
                    </li>

                   

                    <li data-username="Table bootstrap datatable footable" class="nav-item navbarLink11">
                        <a href="./employeeTasks.html" class="nav-link "><span class="pcoded-micon"><i class="fa-solid fa-list-check"></i></span><span class="pcoded-mtext">Tasks</span></a>
                    </li>

                    <li data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Tooltip on top" class="nav-item navbarLink12">
                        <a href="employeeNotifications.html" class="nav-link "><span class="pcoded-micon"><i class="fa-solid fa-person"></i></span><span class="pcoded-mtext">Notifications
                                </span></a>
                    </li>

                    <li data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Tooltip on top" class="nav-item navbarLink13">
                        <a href="employeeDownloadHistory.html" class="nav-link "><span class="pcoded-micon"><i class="fa-solid fa-person"></i></span><span class="pcoded-mtext">Download History
                                </span></a>
                    </li>

                    <li data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Tooltip on top" class="nav-item navbarLink14">
                        <a href="employeeSite.html" class="nav-link "><span class="pcoded-micon"><i class="fa-regular fa-building"></i></span><span class="pcoded-mtext">Site
                                </span></a>
                    </li>


                   

                    <!-- <li class="nav-item pcoded-menu-caption">
                        <label>Pages</label>
                    </li>
                    <li data-username="Authentication Sign up Sign in reset password Change password Personal information profile settings map form subscribe"
                        class="nav-item pcoded-hasmenu">
                        <a href="javascript:" class="nav-link "><span class="pcoded-micon"><i
                                    class="feather icon-lock"></i></span><span
                                class="pcoded-mtext">Authentication</span></a>
                        <ul class="pcoded-submenu">
                            <li class=""><a href="../auth-signup.html" class="" target="_blank">Sign up</a></li>
                            <li class=""><a href="../auth-signin.html" class="" target="_blank">Sign in</a></li>
                        </ul>
                    </li> -->

                </ul>
            </div>
        </div>
    </nav>
    <!-- [ navigation menu ] end -->

    <!-- [ Header ] start -->
    <header class="navbar pcoded-header navbar-expand-lg navbar-light">
        <div class="m-header">
            <a class="mobile-menu" id="mobile-collapse1" href="javascript:"><span></span></a>
            <a href="employee.html" class="b-brand">

                <span class="b-title">Alpha Builders</span>
            </a>
        </div>
        <a class="mobile-menu" id="mobile-header" href="javascript:">
            <i class="feather icon-more-horizontal"></i>
        </a>
        <div class="collapse navbar-collapse">
            <ul class="navbar-nav mr-auto">
                <li><a href="javascript:" class="full-screen" onclick="javascript:toggleFullScreen()"><i
                            class="feather icon-maximize"></i></a></li>
                <!-- <li class="nav-item dropdown">
                    <a class="dropdown-toggle" href="javascript:" data-toggle="dropdown">Dropdown</a>
                    <ul class="dropdown-menu">
                        <li><a class="dropdown-item" href="javascript:">Action</a></li>
                        <li><a class="dropdown-item" href="javascript:">Another action</a></li>
                        <li><a class="dropdown-item" href="javascript:">Something else here</a></li>
                    </ul>
                </li> -->
                <!-- <li class="nav-item">
                    <div class="main-search">
                        <div class="input-group">
                            <input type="text" id="m-search" class="form-control" placeholder="Search . . .">
                            <a href="javascript:" class="input-group-append search-close">
                                <i class="feather icon-x input-group-text"></i>
                            </a>
                            <span class="input-group-append search-btn btn btn-primary">
                                <i class="feather icon-search input-group-text"></i>
                            </span>
                        </div>
                    </div>
                </li> -->
            </ul>
            <ul class="navbar-nav ml-auto">
                <!-- <li>
                    <div class="dropdown">
                        <a class="dropdown-toggle" href="javascript:" data-toggle="dropdown"><i
                                class="icon feather icon-bell"></i></a>
                        <div class="dropdown-menu dropdown-menu-right notification">
                            <div class="noti-head">
                                <h6 class="d-inline-block m-b-0">Notifications</h6>
                                <div class="float-right">
                                    <a href="javascript:" class="m-r-10">mark as read</a>
                                    <a href="javascript:">clear all</a>
                                </div>
                            </div>
                            <ul class="noti-body">
                                <li class="n-title">
                                    <p class="m-b-0">NEW</p>
                                </li>
                                <li class="notification">
                                    <div class="media">
                                        <img class="img-radius" src="../assets/images/user/avatar-1.jpg"
                                            alt="Generic placeholder image">
                                        <div class="media-body">
                                            <p><strong>John Doe</strong><span class="n-time text-muted"><i
                                                        class="icon feather icon-clock m-r-10"></i>30 min</span></p>
                                            <p>New ticket Added</p>
                                        </div>
                                    </div>
                                </li>
                                <li class="n-title">
                                    <p class="m-b-0">EARLIER</p>
                                </li>
                                <li class="notification">
                                    <div class="media">
                                        <img class="img-radius" src="../assets/images/user/avatar-2.jpg"
                                            alt="Generic placeholder image">
                                        <div class="media-body">
                                            <p><strong>Joseph William</strong><span class="n-time text-muted"><i
                                                        class="icon feather icon-clock m-r-10"></i>30 min</span></p>
                                            <p>Prchace New Theme and make payment</p>
                                        </div>
                                    </div>
                                </li>
                                <li class="notification">
                                    <div class="media">
                                        <img class="img-radius" src="../assets/images/user/avatar-3.jpg"
                                            alt="Generic placeholder image">
                                        <div class="media-body">
                                            <p><strong>Sara Soudein</strong><span class="n-time text-muted"><i
                                                        class="icon feather icon-clock m-r-10"></i>30 min</span></p>
                                            <p>currently login</p>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                            <div class="noti-footer">
                                <a href="javascript:">show all</a>
                            </div>
                        </div>
                    </div>
                </li> -->
                <li>
                    <div class="dropdown drp-user">
                        <a href="javascript:" class="dropdown-toggle" data-toggle="dropdown">
                            <i class="icon feather icon-settings"></i>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right profile-notification">
                            <div class="pro-head">
                                <img src="../assets/images/user/avatar-1.jpg" class="img-radius"
                                    alt="User-Profile-Image">
                                <span id="employeeProfileName" >Welcome ADMIN</span>
                                <!-- <a href="../index.html" class="dud-logout" title="Logout"> -->
                                    
                                <!-- </a> -->
                            </div>
                            <ul class="pro-body">
                                <li onclick="employeeLogout()" ><a style="display: flex;align-items: center;justify-content: center;font-size: 16px;" href="javascript:" class="dropdown-item"><i  class="feather icon-log-out"></i>
                                        Log Out</a></li>
                                <!-- <li><a href="javascript:" class="dropdown-item"><i class="feather icon-user"></i>
                                        Profile</a></li>
                                <li><a href="../message.html" class="dropdown-item"><i class="feather icon-mail"></i> My
                                        Messages</a></li>
                                <li><a href="../auth-signin.html" class="dropdown-item"><i
                                            class="feather icon-lock"></i> Lock Screen</a></li> -->
                            </ul>
                        </div>
                    </div>
                </li>
            </ul>
        </div>
    </header>
    <!-- [ Header ] end -->

    <!-- [ Main Content ] start -->
    <section class="pcoded-main-container">
        <div class="pcoded-wrapper">
            <div class="pcoded-content">
                <div class="pcoded-inner-content">
                    <!-- [ breadcrumb ] start -->
                    <div class="page-header">
                        <div class="page-block">
                            <div class="row align-items-center">
                                <div class="col-md-12">
                                    <div style="display: flex;align-items: center;justify-content: center;" class="page-header-title">
                                        <!-- <h3 class="m-b-10">Applicant List Table</h3> -->
                                    </div>
                                    <ul class="breadcrumb">
                                        <li class="breadcrumb-item"><a href="employee.html"><i
                                                    class="feather icon-home"></i></a></li>
                                        <!-- <li class="breadcrumb-item"><a href="#!">Tables</a></li> -->
                                        <li class="breadcrumb-item"><a href="employeeAttendance.html">Employee Attendance List</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- [ breadcrumb ] end -->
                    <div class="main-body">
                        <div class="page-wrapper">
                            <!-- [ Main Content ] start -->
                            <div class="row">





                               

                                <!-- [ Hover-table ] start -->
                                <div class="col-xl-12">
                                    <div class="card">
                                        <div class="card-header" style="display: flex;justify-content: space-between;">
                                            <h3>Employee Attendance List</h3>

                                            <button type="button" class="btn" style="background-color: #333f54; color: white;" id="downloadExcelButton">
                                                Download Excel
                                              </button>
    
                                            <!-- <span class="d-block m-t-5">use class <code>table-hover</code> inside table element</span> -->
                                        </div>

                                        
                                        

                                        <div style="display: flex;justify-content: space-between;align-items: center;" class="ms-5" >

                                            <div style="display: flex;justify-content: start;" >
                                               <h5>Attendance of  <span data-bs-toggle="modal" data-bs-target="#staticBackdrop" style="font-weight: bold;cursor: pointer;" id="attendanceShowDate" > </span> </h5>
                                             </div>

                                            <button type="button" class="btn" style="background-color: #333f54; color: white;" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                                                Attendance Filter
                                              </button>

                                              <button type="button" class="btn" style="background-color: #333f54; color: white;" data-bs-toggle="modal" data-bs-target="#staticBackdrop11">
                                                Add Attendance
                                              </button>

                                              <button type="button" class="btn" style="background-color: #333f54; color: white;" data-bs-toggle="modal" data-bs-target="#staticBackdrop112">
                                                Filter Month Attendance
                                              </button>

                                              <button type="button" class="btn" style="background-color: #333f54; color: white;" data-bs-toggle="modal" data-bs-target="#staticBackdrop114">
                                                Automatic Attendance
                                              </button>

                                             
                                             

                                                <!-- <input id="employeeSearch" type="text" class="form-control w-25 me-3"
                                                    placeholder="Employee Name / Site Name"> -->
    
                                                <!-- <button type="button" class="btn me-3"
                                                    style="margin: 0;padding: 0; height: 42px;width: 130px; font-weight: bold;background-color: #333f54; color: white;"
                                                    data-bs-toggle="modal" data-bs-target="#staticBackdrop">
                                                    <i class="fa-solid fa-plus"></i>Add Tasks
                                                </button> -->
    
    
                                            
                                        </div>

                                        <!-- Modal start -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Attendance Filter</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          
            <div class="mb-3">
                <label for="exampleFormControlInput1"
                    class="form-label">Attendance Date</label>
                <input type="date" class="form-control"
                    id="adminAttendanceDateFilter" placeholder="Select Date">
            </div>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button onclick="filterDate()" data-bs-dismiss="modal" type="button" class="btn btn-primary">Filter Date</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal End -->


   <!-- Attendance date month Filter Starts Modal  -->




  <div class="modal fade" id="staticBackdrop112" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Attendance Filter</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          
            <div class="mb-3">
                <label for="exampleFormControlInput1"
                    class="form-label">Attendance Start Date</label>
                <input type="date" class="form-control"
                    id="attendanceStartDate" placeholder="Select Start Date">
            </div>

            <div class="mb-3">
                <label for="exampleFormControlInput1"
                    class="form-label">Attendance End Date</label>
                <input type="date" class="form-control"
                    id="attendanceEndDate" placeholder="Select End Date">
            </div>

            <div class="mb-3">
                <label for="exampleFormControlInput1"
                    class="form-label">Select Employee From Dropdown</label>
                    <select id="attendanceMonthFilterEmployee" class="form-select" aria-label="Default select example">
                        <option selected>Office ID</option>
                        
                      </select>
            </div>


        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button onclick="filterDate()" data-bs-dismiss="modal" type="button" class="btn btn-primary">Filter Date</button>
        </div>
      </div>
    </div>
  </div>


 <!-- Attendance date month Filter Ends Modal  -->







 <!-- Automated Attendance Modal Starts -->


  <div class="modal fade" id="staticBackdrop114" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Automated Attendance</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          
            <div class="mb-3">
                <label for="exampleFormControlInput1"
                    class="form-label">Attendance Date</label>
                <input type="date" class="form-control"
                    id="automatedAttendanceDateForm" placeholder="Select Date">
            </div>

            <!-- <div class="mb-3">
                <label for="exampleFormControlInput1"
                    class="form-label">Attendance Date End</label>
                <input type="date" class="form-control"
                    id="automatedAttendanceDateFormEnd" placeholder="Select Date">
            </div> -->


            <div class="mb-3">
                <label for="exampleFormControlInput1"
                    class="form-label">Attendance Time</label>
                <input type="time" class="form-control"
                    id="automatedAttendanceReportingTime" placeholder="Select Date">
            </div>

            <!-- <div class="mb-3">
                <label for="exampleFormControlInput1"
                    class="form-label">Attendance End Date</label>
                <input type="date" class="form-control"
                    id="attendanceEndDate" placeholder="Select End Date">
            </div> -->

            <!-- <div class="mb-3">
                <label for="exampleFormControlInput1"
                    class="form-label">Select Employee From Dropdown</label>
                    <select id="attendanceMonthFilterEmployee" class="form-select" aria-label="Default select example">
                        <option selected>Office ID</option>
                        
                      </select>
            </div> -->


        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button onclick="automatedAttendanceFunction()" data-bs-dismiss="modal" type="button" class="btn btn-primary">Add Automated Attendance</button>
        </div>
      </div>
    </div>
  </div>


 <!-- Automated Attendance Modal End -->


  <div>

    <!--Add Attendance Modal Starts -->
    <div class="modal fade" id="staticBackdrop11" data-bs-backdrop="static"
        data-bs-keyboard="false" tabindex="-1"
        aria-labelledby="staticBackdropLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 class="modal-title fs-5" id="staticBackdropLabel">Add Attendance Details
                        
                    </h1>
                    <button onclick="removeAlert()" type="button"
                        class="btn-close" data-bs-dismiss="modal"
                        aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    


                    <div class="mb-3">
                        <label for="exampleFormControlInput1"
                            class="form-label">Select Employee From Dropdown</label>
                            <select id="attendanceListEmployeeId" class="form-select" aria-label="Default select example">
                                <option selected>Office ID</option>
                                
                              </select>
                    </div>

                    <div class="mb-3">
                        <label for="exampleFormControlInput1"
                            class="form-label">Date</label>
                        <input type="date" class="form-control"
                            id="adminEmployeeAttendamceDate"
                            placeholder="Enter Address">
                    </div>

                    <!-- <div class="mb-3">
                        <label for="exampleFormControlInput1"
                            class="form-label">Longitude And Latitude</label>
                        <input type="text" class="form-control"
                            id="adminEmployeeAttendamceLongLat"
                            placeholder="Enter Longitude And Latitude Details">
                    </div> -->

                    <!-- <div class="mb-3">
                        <label for="exampleFormControlInput1"
                            class="form-label">Accuracy</label>
                        <input type="text" class="form-control"
                            id="adminEmployeeAttendamceAccuracy"
                            placeholder="Enter Accuracy Details">
                    </div> -->

                    <!-- <div class="mb-3">

                        <label for="exampleFormControlInput1"
                        class="form-label">Designation</label> -->
<!-- 
                    <select id="adminEmployeeDesignation" class="form-select"
                    aria-label="Default select example"> -->
                    <!-- <option selected>Open this select menu</option> -->
                    <!-- <option value="Administration">Administration</option>
                    <option value="Management">Management</option>
                    <option value="Documentation">Documentation</option>
                    <option value="Finance">Finance</option>
                    <option value="Agent">Agent</option>
                    
                </select> -->

<!--                                                                 
                        <label for="exampleFormControlInput1"
                            class="form-label">Designation</label>
                        <input type="text" class="form-control"
                            id="adminEmployeeDesignation"
                            placeholder="Enter Designation"> -->
                    <!-- </div> -->

                    <div class="mb-3">
                        <label for="exampleFormControlInput1"
                            class="form-label">Reporting Time</label>
                        <input type="time" class="form-control"
                            id="adminEmployeeAttendamceReportTime"
                            placeholder="Enter Reporting Time">
                    </div>


                    <!-- <div class="mb-3">
                        <label for="exampleFormControlInput1"
                            class="form-label">Age</label>
                        <input type="number" class="form-control"
                            id="adminEmployeeAge" placeholder="Enter Age">
                    </div>

                    <div class="mb-3">
                        <label for="exampleFormControlInput1"
                            class="form-label">Phone Number</label>
                        <input type="number" class="form-control"
                            id="adminEmployeePhone"
                            placeholder="Enter Phone Number">

                        <span style="color: red;" class="mt-3"
                            id="alertPhone"></span>
                    </div>

                    <div class="mb-3">
                        <label for="exampleFormControlInput1"
                            class="form-label">Email</label>
                        <input type="email" class="form-control"
                            id="adminEmployeeEmail" placeholder="Enter Email">
                    </div>

                    <div class="mb-3">
                        <label for="exampleFormControlInput1"
                            class="form-label">Date</label>
                        <input type="date" class="form-control"
                            id="adminEmployeeDate" placeholder="Select Date">
                    </div> -->


                </div>
                <div class="modal-footer">
                    <button onclick="removeAlert()" type="button"
                        class="btn btn-danger"
                        data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-success"
                        onclick="addAttendanceDetails()"
                        style="color: black;">Update Attendence Details</button>

                    <button type="button" class="btn btn-warning"
                        onclick="clearFormData()" style="color: black;">Clear
                        Form</button>
                </div>
            </div>
        </div>
    </div>
</div>


<!--Add attendance Modal End -->


                                        <div class="card-block table-border-style">
                                            <div class="table-responsive">
                                                <table class="table table-hover">
                                                    <thead class="table-light" >
                                                        <tr style="font-size: 15px;">
                                                            <!-- <th id="listNumber" >#</th> -->
                                                            
                                                            <th>Employee ID</th>
                                                            <th>Employee Name</th>
                                                            <th>Date</th>
                                                            
                                                            <th id="hideStatusOfTable" >Status</th>

                                                            <th>Total Time in Hours</th>
                                                            <!-- <th>Remarks</th>
                                                            <th>Device Id</th>
                                                            <th>In Place</th>
                                                            <th>Out Place</th> -->

                                                            <th>Punch In <br> Time</th>
                                                            <th>Punch Out <br> Time</th>
                                                            <th>View Tasks</th>
                                                            <th>Punching <br> Status</th>

                                                           
                                                           


                                                          
                                                            
                                                        </tr>
                                                    </thead>
                                                    <tbody id="tablevalue" class="table-group-divider">

                                                        

                                                    </tbody>
                                                </table>
                                                <div style="text-align: center;" >
                                                    <p id="attendanceDataAlertMessage" style="font-size: 20px;" ></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- [ Hover-table ] end -->


                                <!-- Pagination Starts -->

                                <nav aria-label="Page navigation example">
                                    <ul class="pagination justify-content-center" id="pagination"></ul>
                                  </nav>

                                 

                                
                            </div >
                            <!-- [ Main Content ] end -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- [ Main Content ] end -->

    

    <!-- Required Js -->

    <script src="commonApi.js" ></script>
    <script src="../assets/js/vendor-all.min.js"></script>
    <script src="../assets/plugins/bootstrap/js/bootstrap.min.js"></script>
    <script src="../assets/js/pcoded.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>


<!-- cookies script -->

<!-- <script src="employeeRole.js" ></script> -->
<!-- <script src="employeeCookie.js" ></script> -->
<script src="employeeLogout.js" ></script>

    <script>
        
       

        const automatedFunction = (dateValue) => {

            const today = new Date().toISOString().split('T')[0]; // UTC date
const localTodayDate = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000).toISOString().split('T')[0]; // Local date

            const postData = {
"query": "UPDATE task SET task_totaltime = (SELECT COALESCE(SUM(CAST(total_time AS FLOAT)), 0) FROM punching WHERE punching.task_f_id = task.id) WHERE task.attendance_f_id IN (SELECT id FROM attendance WHERE date ='"+dateValue+"');"
}

console.log("post data in enquiry form is ",postData)

axios.post(employeeApi, postData)
.then((response) => {
    console.log('Called the updated function query :', response.data);
//    window.location.reload();
})
.catch((error) => {
    console.error('Error:', error);
});

            
        }

        // automatedFunction()

//var employeeOfficeIdSavedFromDbToLogin = localStorage.getItem('employeeOfficeIdSavedFromDbToLogin')
//var employeeUniqueIdSavedFromDbInLsIndex = localStorage.getItem('employeeUniqueIdSavedFromDbInLsIndex')

//var employeeProfileName = localStorage.getItem('employeeNameSavedFromDbInLs')
  //      console.log(employeeProfileName)

        // document.getElementById('employeeProfileName').innerHTML = 'Welcome '

// const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
// const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))

// var dataPerPage = 10;
//     var currentPage = 1;
//     var reversedValue = [];

//     function paginateData(data, currentPage, dataPerPage) {
//       var startIndex = (currentPage - 1) * dataPerPage;
//       var endIndex = startIndex + dataPerPage;
//       return data.slice(startIndex, endIndex);
//     }

// Select Office from the status query
const postDataOfOfficeNumber = {
            "query": "select id,name,user_id from employ WHERE status='Active';"

        };

        axios.post(employeeApi, postDataOfOfficeNumber)
            .then((response) => {
                const companies = response.data.message.rows;
                console.log('Total number of offiece ', companies)

                let listOfCompany = document.getElementById('attendanceListEmployeeId');
        listOfCompany.innerHTML = ''; // Clear existing options

        // listOfCompany.innerHTML += `<option selected>Office ID</option>`;
        companies.forEach(company => {
            listOfCompany.innerHTML += `<option value="${company.id}">${company.name}</option>`;
        });
    })
            .catch((error) => {
                console.error('Error:', error);
            });




            const postDataMonthFilter = {
            "query": "select id,name,user_id from employ WHERE status='Active';"

        };

        axios.post(employeeApi, postDataMonthFilter)
            .then((response) => {
                const companies = response.data.message.rows;
                console.log('Total number of offiece ', companies)

                let listOfCompany = document.getElementById('attendanceMonthFilterEmployee');
        listOfCompany.innerHTML = ''; // Clear existing options

        // listOfCompany.innerHTML += `<option selected>Office ID</option>`;
        companies.forEach(company => {
            listOfCompany.innerHTML += `<option value="${company.id}">${company.name}</option>`;
        });
    })
            .catch((error) => {
                console.error('Error:', error);
            });



            

function populateTable(data,hideStatus,consolidatedDteView) {

    // var attendanceDataVariable = data;
  var table = document.getElementById("tablevalue");
  table.innerHTML = "";

  let currentDate = null;

  console.log('thae data issssmss',data)

  if (hideStatus) {
    document.getElementById('hideStatusOfTable').style.display = 'none';
  } else {
    document.getElementById('hideStatusOfTable').style.display = '';
  }
  
//   const searchValue = document.getElementById('employeeSearch').value.toLowerCase();

if(data.length == 0){
    
    document.getElementById('attendanceDataAlertMessage').innerHTML = 'No data to display'
}


// document.getElementById('attendanceDataAlertMessage').style.display = 'none'


  data.forEach((value, index) => {
    const date = value.date.slice(0, 10);
    console.log(date)
    if (date !== currentDate) {
    //   table.innerHTML += `<tr style='color:black;cursor:pointer;font-size:18px;'><td colspan='6'>Attendance Of <strong> ${date}</strong></td></tr>`;
    document.getElementById('attendanceShowDate').innerHTML = date;
      currentDate = date;
    }

    if(value == true){
        document.getElementById('hideStatusOfTable').style.display = 'none'
        // document.getElementById('attendanceShowDate').innerHTML = consolidatedDteView;


    }

    var totalTimeInMonth = value.total_time

    // if (value.name.toLowerCase().includes(searchValue)) {

    
        table.innerHTML += `<tr style='color:black;cursor:pointer;'>
  <td>${value.employ_f_id}</td>
  <td>${value.name}</td>
  <td>${date}</td>
  <td style="${hideStatus ? 'display: none;' : ''}">
    <select style="width: 140px;" class="form-select" aria-label="Default select example" onchange="updateStatus(this.value, ${value.id})">
      <option ${value.status === 'Active' ? 'selected' : ''}>Active</option>
      <option ${value.status === 'Pending' ? 'selected' : ''}>Pending</option> 
    </select>
  </td>
  <td>${value.total_time}</td>
  <td>${value.first_time}</td>
  <td>${value.last_time}</td>
  <td><button class="btn" onclick="addTaskAttendance(${value.id}, ${value.employ_f_id})" style="background-color: #333f54; color: white;">View Tasks</button></td>
   <td>
            ${value.thispunch_id === null || value.thispunch_id === ""
                ? '<div class="circle green"></div>' 
                : '<div class="circle red blink"></div>'}
        </td>
</tr>`;
// }
  });

}
// document.getElementById('employeeSearch').addEventListener('keyup', populateTable);


function convertTo12HourFormat(time) {
  let [hours, minutes] = time.split(':');
  hours = parseInt(hours, 10);

  let period = 'AM';
  if (hours >= 12) {
    period = 'PM';
    if (hours > 12) {
      hours -= 12;
    }
  } else if (hours === 0) {
    hours = 12;
  }

  // Ensure minutes are always two digits
  minutes = minutes.padStart(2, '0');

  return `${hours}:${minutes} ${period}`;
}



function updateStatus(status, index) {

//console.log('The name of id is: ',appId)
//console.log('The name of date is: ',appDate)
//console.log('The name of id is: ',appName)

event.stopPropagation();
// console.log('Id value inside the update status is :',newId)
const postData = {
"query": "Update attendance SET status='"+status+"' where id='"+index+"';"
}

console.log("post data in enquiry form is ",postData)

axios.post(employeeApi, postData)
.then((response) => {
    console.log('Updated Data :', response.data);
   window.location.reload();
})
.catch((error) => {
    console.error('Error:', error);
});

    }







    // function renderPagination(totalPages) {
    //   var pagination = document.getElementById("pagination");
    //   pagination.innerHTML = "";
    //   for (var i = 1; i <= totalPages; i++) {
    //     pagination.innerHTML += `<li class="page-item ${currentPage === i ? 'active' : ''}"><a class="page-link" href="#" onclick="changePage(${i})">${i}</a></li>`;
    //   }
    // }

    // function changePage(page) {
    //   currentPage = page;
    //   var paginatedData = paginateData(reversedValue, currentPage, dataPerPage);
    //   populateTable(paginatedData);
    //   renderPagination(Math.ceil(reversedValue.length / dataPerPage));
    // }

    // var resp = fetch('https://script.google.com/macros/s/AKfycbxqKl5ocHojsFWfuiPSqWSens992EGdApaadzoUFEUeo10-E6kKcdZlyT2ULxpAZ0c/exec')
    //   .then(response => response.json())
    //   .then(data => {
    //     reversedValue = data.slice().reverse();
    //     changePage(currentPage);
    //   })
    //   .catch(error => console.error('Error fetching data:', error));




      // 
      var dateNew
     
      // Attendance Filter Function

      var excelDataToPrint 

      function filterDate() {
     dateNew = document.getElementById('adminAttendanceDateFilter').value;
     attendanceStartDate = document.getElementById('attendanceStartDate').value
     attendanceEndDate = document.getElementById('attendanceEndDate').value
    
    console.log('The date is ',dateNew)
    if(dateNew){
        var valueOf;
        document.getElementById('downloadExcelButton').style.display = 'none'

       

      
// const postData = {
// "query": "SELECT attendance.*, employ.name,employ.punch_id AS thisPunch_id, SUM(task.task_totaltime) AS time, (SELECT punching.out_time FROM punching INNER JOIN task AS t ON punching.task_f_id = t.id WHERE t.attendance_f_id = attendance.id ORDER BY punching.in_time DESC LIMIT 1) AS last_time, (SELECT punching.in_time FROM punching INNER JOIN task AS t ON punching.task_f_id = t.id WHERE t.attendance_f_id = attendance.id LIMIT 1) AS first_time FROM attendance INNER JOIN employ ON attendance.employ_f_id = employ.id INNER JOIN task ON task.attendance_f_id = attendance.id WHERE attendance.date = '"+dateNew+"' GROUP BY attendance.id,employ.punch_id, employ.name;"
// }

const postData = {
    
"query": "SELECT attendance.*, employ.name, employ.punch_id AS thisPunch_id, COALESCE(SUM(punching.total_time), 0) AS total_time, (SELECT punching.out_time FROM punching INNER JOIN task AS t ON punching.task_f_id = t.id WHERE t.attendance_f_id = attendance.id ORDER BY punching.in_time DESC LIMIT 1) AS last_time, (SELECT punching.in_time FROM punching INNER JOIN task AS t ON punching.task_f_id = t.id WHERE t.attendance_f_id = attendance.id LIMIT 1) AS first_time FROM attendance INNER JOIN employ ON attendance.employ_f_id = employ.id LEFT JOIN task ON task.attendance_f_id = attendance.id LEFT JOIN punching ON punching.task_f_id = task.id WHERE attendance.date = '"+dateNew+"' GROUP BY attendance.id, employ.punch_id, employ.name;"


}

console.log('The post data of attendance is consoled here :',postData)
console.log('')

axios.post(employeeApi, postData)
    .then((response) => {
        valueOf = response.data.message.rows;
        // changePage(currentPage);
        console.log("value of the values in the attendance tab ======", valueOf);

        
        valueOf.length>0 ? populateTable(valueOf) : alert(`No attendance to display in ${dateNew.slice(0,10)}` )
        
        // window.location.reload()

        // const employeeTaskTable = document.getElementById('employeeTaskTable');
    })

    }

    else if(attendanceEndDate && attendanceStartDate){

document.getElementById('downloadExcelButton').style.display = 'Block'

        var valueOfFilterDate;
        let attendanceMonthFilterEmployee = document.getElementById('attendanceMonthFilterEmployee').value;

      
const postData = {
"query": "SELECT attendance.*, employ.name, employ.punch_id AS thisPunch_id, COALESCE(SUM(punching.total_time), 0) AS total_time, (SELECT punching.out_time FROM punching INNER JOIN task AS t ON punching.task_f_id = t.id WHERE t.attendance_f_id = attendance.id ORDER BY punching.in_time DESC LIMIT 1) AS last_time, (SELECT punching.in_time FROM punching INNER JOIN task AS t ON punching.task_f_id = t.id WHERE t.attendance_f_id = attendance.id LIMIT 1) AS first_time FROM attendance INNER JOIN employ ON attendance.employ_f_id = employ.id LEFT JOIN task ON task.attendance_f_id = attendance.id LEFT JOIN punching ON punching.task_f_id = task.id WHERE attendance.date BETWEEN '"+attendanceStartDate+"' AND '"+attendanceEndDate+"' AND employ.id = '"+attendanceMonthFilterEmployee+"' GROUP BY attendance.id, employ.punch_id, employ.name ORDER BY attendance.date;;"

}

console.log('The post data of attendance is consoled here :',postData)

axios.post(employeeApi, postData)
    .then((response) => {
        valueOfFilterDate = response.data.message.rows;
        // changePage(currentPage);
        console.log("value of the values in the attendance tab ======", valueOfFilterDate);
        // var hideStatus = true;

        
        // valueOf.length>0 ? populateTable(valueOfFilterDate) : alert(`No attendance to display in ${dateNew.slice(0,10)}` )
        var consolidatedDteView = attendanceStartDate+ ' ' + attendanceEndDate

        populateTable(valueOfFilterDate,true,consolidatedDteView) 
     
        excelDataToPrint = valueOfFilterDate;

        
        
        // window.location.reload()

        // const employeeTaskTable = document.getElementById('employeeTaskTable');
    })


    }

    else{
        const today = new Date().toISOString().split('T')[0]; // UTC date
const localToday = new Date(new Date().getTime() - new Date().getTimezoneOffset() * 60000).toISOString().split('T')[0]; // Local date

        console.log('Today is',localToday)

        var valueOfThis;

document.getElementById('downloadExcelButton').style.display = 'none'
 
const postData = {
"query": "SELECT attendance.*, employ.name, employ.punch_id AS thisPunch_id, COALESCE(SUM(punching.total_time), 0) AS total_time, (SELECT punching.out_time FROM punching INNER JOIN task AS t ON punching.task_f_id = t.id WHERE t.attendance_f_id = attendance.id ORDER BY punching.in_time DESC LIMIT 1) AS last_time, (SELECT punching.in_time FROM punching INNER JOIN task AS t ON punching.task_f_id = t.id WHERE t.attendance_f_id = attendance.id LIMIT 1) AS first_time FROM attendance INNER JOIN employ ON attendance.employ_f_id = employ.id LEFT JOIN task ON task.attendance_f_id = attendance.id LEFT JOIN punching ON punching.task_f_id = task.id WHERE attendance.date = '"+localToday+"'  GROUP BY attendance.id, employ.punch_id, employ.name;"

}


console.log('The post data of attendance is consoled here :',postData)

axios.post(employeeApi, postData)
    .then((response) => {
        valueOfThis = response.data.message.rows;
        // changePage(currentPage);
        console.log("value of the values in the attendance tab", valueOfThis);

        

        populateTable(valueOfThis)

        

        // const employeeTaskTable = document.getElementById('employeeTaskTable');
    })
    }

    document.getElementById('adminAttendanceDateFilter').value = ''
}

filterDate()

     
      
    // Function to add the attendance details 
    
    function addAttendanceDetails() {
            var attendanceListEmployeeId = document.getElementById('attendanceListEmployeeId').value
            var adminEmployeeAttendamceDate = document.getElementById('adminEmployeeAttendamceDate').value
            // var adminEmployeeAttendamceLongLat = document.getElementById('adminEmployeeAttendamceLongLat').value
            // var adminEmployeeAttendamceAccuracy = document.getElementById('adminEmployeeAttendamceAccuracy').value
            var adminEmployeeAttendamceReportTime = document.getElementById('adminEmployeeAttendamceReportTime').value
            // var adminEmployeeDepartment = document.getElementById('adminEmployeeDepartment').value
            // var adminEmployeeAge = document.getElementById('adminEmployeeAge').value
            // var adminEmployeePhone = document.getElementById('adminEmployeePhone').value
            // var adminEmployeeEmail = document.getElementById('adminEmployeeEmail').value
            // var adminEmployeeDate = document.getElementById('adminEmployeeDate').value


            if (!attendanceListEmployeeId || !adminEmployeeAttendamceDate || !adminEmployeeAttendamceReportTime ) {

                // displayAlert()
               


            }else {

                // removeAlert()
              
                var responseTaken 

const postData = {
    "query": "Insert into attendance (employ_f_id,date,reporting_time) VALUES('"+attendanceListEmployeeId+"','"+adminEmployeeAttendamceDate+"','"+adminEmployeeAttendamceReportTime+"') RETURNING id;"
}

console.log('Post Data of attendance', postData)

axios.post(employeeApi, postData)
    .then((response) => {
        // Handle response if needed

        responseTaken = response.data.message.rows[0].id;

        console.log('Data inserted')
        console.log("Post data of admin task", responseTaken)

        // window.location.reload()
        console.log('After the reload')
        // clearFormData()

        // Now make the second axios.post call
        const automatedDataTask = {
            attid: responseTaken,
            empid: attendanceListEmployeeId
        }

        console.log('The body ', automatedDataTask)

        axios.post(automatedTaskApi, automatedDataTask)
            .then((response) => {
                // Handle response if needed
                console.log('The response is successfully completed')
                console.log(response);
                window.location.reload()
            })
            .catch((error) => {
                console.log('Error:', error);
                console.log('Task adding error')
            });

            

    }) 

    
    .catch((error) => {
        console.log('Error:', error)
        console.log('Attendance adding error');
    });
                
            }

        }



        // DAte Functions

        function formatDate(date) {
    let day = String(date.getDate()).padStart(2, '0');
    let month = String(date.getMonth() + 1).padStart(2, '0'); // Months are 0-based in JavaScript
    let year = date.getFullYear();
    return `${day}-${month}-${year}`;
}

// Function to get all dates between two given dates
function getDatesBetween(startDate, endDate) {
    let dateArray = [];
    let currentDate = new Date(startDate);

    while (currentDate <= endDate) {
        dateArray.push(formatDate(currentDate));
        currentDate.setDate(currentDate.getDate() + 1); // Move to the next day
    }

    return dateArray;
}

// Example usage
// let start = new Date("2024-07-01"); // Start date in yyyy-mm-dd format
// let end = new Date("2024-07-07"); // End date in yyyy-mm-dd format



        // Date Functions ends




        // Automatic attendance add button function starts




        async function automatedAttendanceFunction() {
    const postData = {
        "query": "select id from employ WHERE status='Active';"
    };

    console.log('The post data of automated attendance is consoled here :', postData);

    try {
        const response = await axios.post(employeeApi, postData);
        const valueOfAutomated = response.data.message.rows;
        const lengthOfAutomated = valueOfAutomated.length;
        console.log('The length is: ', lengthOfAutomated);

        const automatedAttendanceReportingTime = document.getElementById('automatedAttendanceReportingTime').value;
        const automatedAttendanceDateForm = document.getElementById('automatedAttendanceDateForm').value;

        for (let i = 0; i < lengthOfAutomated; i++) {
            const idOfAutomatedAttendance = valueOfAutomated[i].id;

            const postData = {
                "query": `Insert into attendance (employ_f_id,date,reporting_time) VALUES('${idOfAutomatedAttendance}','${automatedAttendanceDateForm}','${automatedAttendanceReportingTime}') RETURNING id;`
            };

            console.log('Post Data of attendance', postData);

            try {
                const response = await axios.post(employeeApi, postData);
                const responseTaken = response.data.message.rows[0].id;
                console.log('Data inserted');
                console.log("Post data of admin task", responseTaken);

                const automatedDataTask = {
                    attid: responseTaken,
                    empid: idOfAutomatedAttendance
                };

                console.log('The body ', automatedDataTask);

                try {
                    const response = await axios.post(automatedTaskApi, automatedDataTask);
                    console.log('The response is successfully completed');
                    console.log(response);
                } catch (error) {
                    console.log('Error in automated task API:', error);
                }
            } catch (error) {
                console.log('Error in attendance API:', error);
            }
        }

        alert('Successfully added the attendance');
        window.location.reload()
    } catch (error) {
        console.log('Error in employee API:', error);
    }
}




        // Automated attendance add button function ends



      
    // Add Task in attendance function

    const addTaskAttendance = (idValue,employIdValue) => {

// console.log('The id value is consoled here',idValue)
// console.log('The employee id value is consoled here',employIdValue)
// alert('The function is opened here')

localStorage.setItem('adminAttendanceToTaskIdSavedLs',idValue)
localStorage.setItem('adminAttendanceEmployeeTaskIdSaved',employIdValue)
window.location.href = 'employeeAttendanceTasks.html'

    }
       


// Download Excel function

const downloadExcel = () => {
            const wb = XLSX.utils.book_new();
            const ws_data = excelDataToPrint.map(item => ({
                "Employee Name": item.name,
                "Total Time": item.date,
                "Total Time In Hours": item.total_time,
                "Punch In Time": item.first_time,
                "Punch Out Time": item.last_time,
                // "Date": item.date,
                // "Status": item.status,
                // "Payment ID": item.payment_id,
                // "Project Name": item.name
            }));

            const ws = XLSX.utils.json_to_sheet(ws_data);
            XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
            XLSX.writeFile(wb, "Employee Monthly Attendance.xlsx");
        };

        document.getElementById('downloadExcelButton').addEventListener('click', downloadExcel);



            

    </script>

</body>

</html>